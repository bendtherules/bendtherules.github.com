<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Code Spin - Launch stuff</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Code Spin </a></h1>
                <nav><ul>
                    <li><a href="/category/projects.html">Projects</a></li>
                    <li><a href="/category/trying-stuff.html">Trying stuff</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/HumbleMatch_Launch.html">HumbleMatch - Go sanitize your type-checking</a></h1>
<footer class="post-info">
        <abbr class="published" title="2015-06-19T16:56:00+02:00">
                Published: Fri 19 June 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/bendtherules.html">bendtherules</a>
        </address>
<p>In <a href="/category/projects.html">Projects</a>. </p>
<p>tags: <a href="/tag/humblematch.html">HumbleMatch</a> <a href="/tag/launch-stuff.html">Launch stuff</a> <a href="/tag/projects.html">Projects</a> </p>
</footer><!-- /.post-info --><section>
<h2>What the heck is it?</h2>
<p>HumbleMatch is made to <em>add a zing</em> to your mundane type-checking and duck-checking code.</p>
<ul>
<li>Check your function arguments reliably, add <em>more flexible signatures</em> and most of all, have a lovely API.</li>
<li>Or just <em>sprinkle some assert</em> checks to ensure the data is what you expect it to be at any point.</li>
<li>Provide helpful debugging errors, <em>dont just fail with cryptic errors</em></li>
</ul>
</section>
<section>
<h2>The Pain Point #1</h2>
<p>I am Abhas and personally, I love Python mostly for its intuitive, flexible and beautiful API. But some things, I really hate doing.</p>
<p>For eg, lets say I have a Point class with two function signatures - <code>Point(x,y)</code> and <code>Point([x,y])</code>. Lets see a typical implementation of this -</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Point</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span> <span class="c"># check for Point(x,y)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span> <span class="c"># check for Point([x,y])</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">))</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Pass proper arguments&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Now, definitely there are some shortcuts you could take there, but the point is this process is quite error-prone and repetitive. For eg, one might easily miss the <code>(y is None)</code> or <code>isinstance</code> check in the 2nd case.</p>
<p>Again, this is a pretty basic requirement I imposed upon the <code>__init__</code> method. Wouldnt it be awesome if you could do all this easily and also support dicts like <code>{x:20,y:50}</code> or hell, even objects with <code>obj.x = 20, obj.y =50</code> directly as arguments?</p>
<p>Lets visit the better side</p>
</section>
<section>
<h2>Using HumbleMatch #1</h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">humblematch</span> <span class="kn">import</span> <span class="n">w</span>


<span class="k">class</span> <span class="nc">Point</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">w</span><span class="p">([</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]:</span> <span class="c"># check for Point(x,y)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>            
        <span class="k">elif</span> <span class="n">w</span><span class="p">([[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="bp">None</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]:</span> <span class="c"># check for Point([x,y])</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Pass proper arguments&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Look at the difference on line 6 and line 10 - you can put all those isinstance and length checks in one line, and hopefully, it now becomes easier to grasp what the code does at one look. That <code>w</code> or <code>WrapObj</code> class is the most important among a very few classes that humblematch provides.</p>
<p>So, lets go through this and see how it works.</p>
<h3><code>humblematch.w(object)</code></h3>
<p>Same as humblematch.WrapObj. It acts as a wrapper, and takes as input any object, be it a class like int or float or list or a value like 5.23.</p>
<p>It is in itself useless, but has a specialized __eq__ operator which helps in matching. Object passed to it is considered as the reference against which any other object can be checked.</p>
<h4><code>w(obj) == other</code></h4>
<p>Same as  <code>humblematch.w(obj).__eq__(other)</code></p>
<p>If <em>obj</em> is a <em>class</em>, then it returns True if <em>other</em> is instance of <em>obj</em>. So,can match against types like int.</p>
<p>If not <em>class</em> and not the ones mentioned below, then returns True if <code>obj == other</code>. So, can match against values like 5 or "abcd"</p>
<p>If <em>obj</em> is a list-ish iterable (i.e. not string or dict), then each element is checked against that of <em>other</em>. Returns True if <code>other[index] == obj[index]</code> for every index in <em>obj</em> and they both have same number of elements</p>
<p>If <em>obj</em> is a Mapping (eg dict), returns true if for each key in <em>obj</em>,  <code>other[key] == obj[key]</code>. But it is ok for <em>other</em> to have extra keys</p>
<p>If <em>obj</em> is a Mapping and you use <code>w(obj).as_obj() == other</code>, then <em>other</em> is considered as a Object and all the keys in <em>obj</em> are looked up on <em>other</em> using __getattribute__ i.e. it returns True if <code>other.key == obj[key]</code> for all the keys in <em>obj</em>.</p>
<h3>Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">w</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span> <span class="ow">is</span> <span class="bp">True</span>
<span class="n">w</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">==</span> <span class="mf">5.23</span> <span class="ow">is</span> <span class="bp">False</span>

<span class="n">w</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="ow">is</span> <span class="bp">False</span> <span class="c"># Wont match class itself</span>

<span class="n">w</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span> <span class="ow">is</span> <span class="bp">True</span>
<span class="n">w</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="mf">5.0</span> <span class="ow">is</span> <span class="bp">True</span> <span class="c"># as 5 == 5.0 in Python</span>

<span class="n">w</span><span class="p">([</span><span class="nb">int</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">True</span> <span class="c"># Using list</span>
<span class="n">w</span><span class="p">([</span><span class="nb">int</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="mf">2.23</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">False</span>
<span class="n">w</span><span class="p">([</span><span class="nb">list</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span> <span class="o">==</span> <span class="p">[[</span><span class="mi">200</span><span class="p">],</span> <span class="mi">50</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">True</span>

<span class="n">w</span><span class="p">({</span><span class="s">&quot;a&quot;</span><span class="p">:</span><span class="nb">int</span><span class="p">})</span> <span class="o">==</span> <span class="p">{</span><span class="s">&quot;a&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">:</span><span class="mi">99</span><span class="p">}</span> <span class="ow">is</span> <span class="bp">True</span> <span class="c"># Using dict</span>

<span class="k">class</span> <span class="nc">object2</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">object2</span><span class="p">()</span>
<span class="n">q</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">q</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">99</span>
<span class="n">w</span><span class="p">({</span><span class="s">&quot;b&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">})</span><span class="o">.</span><span class="n">as_obj</span><span class="p">()</span> <span class="o">==</span> <span class="n">q</span> <span class="ow">is</span> <span class="bp">True</span>  <span class="c"># Using object</span>

<span class="n">w</span><span class="p">({</span><span class="s">&quot;a&quot;</span><span class="p">:[</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">]})</span> <span class="o">==</span> <span class="p">{</span><span class="s">&quot;a&quot;</span><span class="p">:[</span><span class="mi">36</span><span class="p">,</span><span class="mf">1.26</span><span class="p">]}</span> <span class="c"># ** OK to nest expressions **</span>
</pre></div>
</td></tr></table>

<p>Also, I promised you that you can just as easily use dicts and objects - but from the previous examples, you probably can guess how to do that. So, if you are willing, just go forward and implement that first. Hopefully, you will love the simplicity.</p>
<p>Now because this is currently the only documentation on it, I'll go ahead with few more examples and provide the remaining doc alongside.</p>
</section>
<section>
<h2>The Pain Point #2</h2>
<p>Lets say, we have a function called <code>diff_list</code>, which given <em>two lists as argument</em>, returns a <em>list of two lists, each of them containing the unique/exclusive elements</em> from the corresponding list passed as argument . (Unique in the sense its not present in the other list). But if any of those return lists dont have any unique argument, the function simply <em>returns <code>None</code> instead of that list</em>.</p>
<p>For simplicity, we also assume that the argument lists themselves dont have repeating elements. So, for eg. <code>diff_list([2,3,4,9],[1,3,9]) == [[2,4],[1]]</code> and <code>diff_list([2,3,4,9],[3,9]) == [[2,4],None]</code></p>
<p>Heres a sample implementation we are going to use -</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">humblematch</span> <span class="kn">import</span> <span class="n">w</span>


<span class="k">def</span> <span class="nf">diff_list</span><span class="p">(</span><span class="n">list_1</span><span class="p">,</span> <span class="n">list_2</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">w</span><span class="p">([</span><span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="n">list_1</span><span class="p">,</span> <span class="n">list_2</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Both arguments must be list or a list-ish iterable&quot;</span><span class="p">)</span>

    <span class="n">exclusive_list_1</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">list_1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ele</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_2</span><span class="p">:</span>
            <span class="n">exclusive_list_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span>

    <span class="n">exclusive_list_2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">list_2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ele</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_1</span><span class="p">:</span>
            <span class="n">exclusive_list_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">exclusive_list_1</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">,</span> <span class="n">exclusive_list_2</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p>Our goal is to test this function from certain directions -</p>
<ol>
<li>Whether it returns a list of two elements, each of which might be another list or None.</li>
<li>Given two lists of any size conataining only float as argument (eg. <code>diff_list([1.12,2.64],[2.56])</code>), whether all the elements in the sub-lists of the returned list are of type float.</li>
</ol>
<p>Obviously, there are some other checks we should do, but this module probably wont be of much help there.</p>
<h2>Test 1</h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">humblematch</span> <span class="kn">import</span> <span class="n">w</span><span class="p">,</span> <span class="n">OR</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span>
<span class="n">list_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))]</span>
<span class="n">list_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))]</span>

<span class="k">assert</span><span class="p">(</span><span class="n">diff_list</span><span class="p">(</span><span class="n">list_1</span><span class="p">,</span> <span class="n">list_2</span><span class="p">)</span> <span class="o">==</span> <span class="n">w</span><span class="p">([</span><span class="n">OR</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="n">OR</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]))</span>
</pre></div>
</td></tr></table>

<p>We need to check that each element in the returned list is either a list or None. So, we need to have some way of checking one argument against a number of types and values, where the check returns True if any of them satisfies. That why we have <code>humblematch.OR(obj1, obj2, ...)</code></p>
<h3><code>humblematch.OR(obj1, obj2, ...)</code></h3>
<p>Also has the signature <code>humblematch.OR([obj1, obj2, ...])</code>.</p>
<p><code>OR(obj1,obj2, ...) == other</code> returns True if <code>other</code> matches (isinstance of or is equal to) any of the <code>obj</code> passed as argument.</p>
<p><code>OR</code> also has all the facilities of <code>w</code>, so its not required to use <code>w(OR())</code> - it is functionally equivalent to just <code>OR()</code>.</p>
<h4>Example</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">OR</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span> <span class="ow">is</span> <span class="bp">True</span>
<span class="n">OR</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="o">==</span> <span class="mf">2.26</span> <span class="ow">is</span> <span class="bp">True</span>
<span class="n">w</span><span class="p">(</span><span class="n">OR</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="bp">None</span><span class="p">]))</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">is</span> <span class="bp">True</span>
<span class="n">w</span><span class="p">(</span><span class="n">OR</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">==</span> <span class="mi">5</span> <span class="ow">is</span> <span class="bp">True</span>
</pre></div>
</td></tr></table>

<h3><code>humblematch.ANY</code></h3>
<p>Similar to <code>OR</code>, there is <code>humblematch.ANY</code> which matches object of any type. It is usually used when we dont care about the type of the argument, but still want it to be there. Also, <code>ANY</code> has all facilities of <code>w</code> just like <code>OR</code>.</p>
<h4>Example</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">w</span><span class="p">(</span><span class="n">Any</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">is</span> <span class="bp">True</span>
<span class="n">Any</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span><span class="p">,{</span><span class="s">&quot;a&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">}]</span> <span class="ow">is</span> <span class="bp">True</span>
</pre></div>
</td></tr></table>

<p>Both <code>ANY</code> and <code>OR</code> work like Abstract Base Class (ABC). Along with this, we could also use any ABC for eg. those defined in <code>types</code> and <code>number</code> module.
HumbleMatch makes some of the common ones available directly, with slight modifications in some of them (specifically StringTypes). The available ones are:</p>
<ul>
<li><code>StringTypes</code> - Matches strings of both types, <code>str</code> and <code>unicode</code></li>
<li><code>NumberType</code> - Matches any kind of number (like <code>int</code> or <code>float</code>)</li>
<li><code>FunctionType</code> - Matches any function (useful for checking methods in object)</li>
<li><code>ClassType</code> - Matches any class (Probably both new and old-style class)</li>
</ul>
<p><code>ANY</code> and <code>OR</code> are more important in nested expressions like</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">w</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="nb">int</span><span class="p">,</span> <span class="n">OR</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="nb">int</span><span class="p">),</span> <span class="n">Any</span><span class="p">])</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="s">&quot;asd&quot;</span><span class="p">,</span> <span class="p">[{</span><span class="s">&quot;a&quot;</span><span class="p">:</span><span class="mi">55</span><span class="p">}]]</span> <span class="ow">is</span> <span class="bp">True</span>
</pre></div>
</td></tr></table>

<h2>Test 2</h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">humblematch</span> <span class="kn">import</span> <span class="n">w</span><span class="p">,</span> <span class="n">inf</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span>
<span class="n">list_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))]</span> <span class="c">#eg [1.23,5.32]</span>
<span class="n">list_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))]</span> <span class="c">#eg [3.3,5.32,6.7]</span>

<span class="k">assert</span><span class="p">(</span><span class="n">diff_list</span><span class="p">(</span><span class="n">list_1</span><span class="p">,</span> <span class="n">list_2</span><span class="p">)</span> <span class="o">==</span> <span class="n">w</span><span class="p">([[</span><span class="n">w</span><span class="p">([</span><span class="nb">float</span><span class="p">])</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inf</span><span class="p">)],</span>
                                       <span class="p">[</span><span class="n">w</span><span class="p">([</span><span class="nb">float</span><span class="p">])</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inf</span><span class="p">)]]))</span>
</pre></div>
</td></tr></table>

<p>Lets say <code>diff_list(list_1, list_2)</code> returns <code>[list_3, list_4]</code>. We need to check that both <em>list_3</em> and <em>list_4</em> are filled with only float elements. So. to check <em>list_3</em> first, we use <code>[w([float]).times(0, inf)]</code>, which means the list_4 is a list and it consists of elements which can be eaten up by the pattern <code>float</code> when repeated for atleast 0 times and at max infinite times. </p>
<h3><code>humblematch.w([pattern_1, pattern_2, ...]).times(min,max)</code></h3>
<p>Also has signature <code>w([pattern_1, pattern_2]).times(exact_times)</code></p>
<p>It works like the <code>*args</code> used in functions, it matches a number of elements which follow the given pattern, but should atleast repeat <code>min</code> times and atmost <code>max-1</code> times (i.e. <code>max</code> times is exclusive, just like <code>range</code> in python), if both arguments are given. If only one is given, it must repeat exactly <code>exact_times</code>. </p>
<p>But hey, what exactly is the pattern <code>[pattern_1, pattern_2, ...]</code>? It means that <code>pattern_1</code> must occur first, followed by <code>pattern_2</code>, followed by others) to be count as one full match and this type of full match can occur in the <code>(min,max)</code> range. If the full match doesnt complete, it is considered invalid and hence doesnt match.</p>
<p>It is used like this :</p>
<h4><code>w([w([pattern_1, pattern_2, ...]).times(min,max)]) == [ele_1, ele_2, ...]</code></h4>
<p>Also, <code>w([pattern_1, pattern_2, ...]).times(min,max)</code> has another alias <code>w([pattern_1, pattern_2, ...])*(min,max)</code>, so we can use <code>*(min,max)</code> instead of <code>.times(min,max)</code> for shorthand purpose.</p>
<p>Infact now that we know this, in Test 2 we can remove the repetion of <code>w([float]).times(0, inf)</code> twice using another <code>.times</code>. Try that if you have some time.</p>
<h2>Its been a long post</h2>
<p>As mentioned, I dont have official doc for this module right now, so I took the liberty of writing a very long post filled with bits of doc here and there. I feel this is better for introducing something, when you show right at front why and how this is used. But yes, this is definitely no reason for not having good reference doc. But I didnt have enough time to do both seperately, so here it is a mix of both - I'll probably just copy aste stuff from here later to make 2 seperate parts.</p>
<p>I purposedly miss only method which is already there, called <code>w(obj).save_as(arg_name)</code>. How it works is that is stores whatever it matches with as <code>"arg_name"</code> and returns a dict filled with all such values, when <code>==</code>d with <code>other</code>. For eg <code>w([2, w(int).save_as("a"), OR(str,dict)).save_as("b")]) == [2,5,{"q":1}]</code> returns <code>{"a":5,"b":{"q":1}}</code>. I didnt document it well beacuse I am not mentally ok with a <code>==</code> call returning anything other than a <code>boolean</code>. Maybe, I will change the API in some way to make it better and document it then. But feel free to also try this, I am proud of this feature :)</p>
<p>And thats all for now, have fun and write more code.</p>
</section>                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Rendered by Pelican</a></li>
                            <li><a href="http://python.org/">Coded in Python</a></li>
                            <li><a href="http://daringfireball.net/projects/markdown/">Written in Markdown</a></li>
                            <li><a href="https://delicious.com/bendtherules">All my bookmarks</a></li>
                        </ul>
                </div><!-- /.blogroll -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>